---
title: "SuRGE Field Duplicates and Field Blanks"
author: "J. Beaulieu and J. Corra"
date: "1/24/2022"
output: pdf_document
---

```{r setup, results='hide', message=FALSE, warning=FALSE, echo=FALSE}

# Identify local path for each user
userPath <- paste0(Sys.getenv("USERPROFILE"), 
                   "/Environmental Protection Agency (EPA)/",
                   "SuRGE Survey of Reservoir Greenhouse gas Emissions - Documents/")

 # localName <- "Jake/" # R proj folder at SP.
localName <- "Joe/" # R proj folder at SP.

# load project libraries
source(paste0(userPath, "rProjects/", localName, "SuRGE/scripts/masterLibrary.R"))

# load data
# Analysis
source(paste0(userPath, "rProjects/", localName, "SuRGE/scripts/analysis/readSurgeLakes.R")) # read in survey design file
source(paste0(userPath, "rProjects/", localName, "SuRGE/scripts/analysis/chemSampleList.R")) # creates chem.samples.foo, an inventory of all collected chem sample


# Read chemistry
# uncomment rows to bring in more data
source(paste0(userPath, "rProjects/", localName, "SuRGE/scripts/analysis/readFieldSheets.R")) # read surgeData...xlsx.  fld_sheet, dg_sheet
source(paste0(userPath, "rProjects/", localName, "SuRGE/scripts/analysis/readAnionsAda.R")) # read ADA lab anions
source(paste0(userPath, "rProjects/", localName, "SuRGE/scripts/analysis/readAnionsDaniels.R")) # read Kit Daniels anions
source(paste0(userPath, "rProjects/", localName, "SuRGE/scripts/analysis/readNutrientsAda.R")) # read nutrients ran in ADA lab
source(paste0(userPath, "rProjects/", localName, "SuRGE/scripts/analysis/readNutrientsAwberc.R")) # read AWBERC lab nutrient results
source(paste0(userPath, "rProjects/", localName, "SuRGE/scripts/analysis/readNutrientsR10_2018.R")) # read AWBERC nutrients for 2018 R10
source(paste0(userPath, "rProjects/", localName, "SuRGE/scripts/analysis/readOcAda.R")) # read ADA TOC/DOC data
source(paste0(userPath, "rProjects/", localName, "SuRGE/scripts/analysis/readOcMasi.R")) # read 2020 TOC run at MASI lab
source(paste0(userPath, "rProjects/", localName, "SuRGE/scripts/analysis/readTteb.R")) # TTEB metals, TOC, DOC
# source(paste0(userPath, "rProjects/", localName, "SuRGE/scripts/analysis/readPigmentsMicrocystin.R")) # NAR chl, phyco, and microcystin
# source(paste0(userPath, "rProjects/", localName, "SuRGE/scripts/analysis/readTaxonomy.R")) # GB taxonomy
source(paste0(userPath, "rProjects/", localName, "SuRGE/scripts/analysis/readChlorophyllR10_2018.R")) # 2018 R10 chlorophyll
```

## Background

SuRGE (Survey of Reservoir Greenhouse gas Emissions) is an national-scale survey of methane (CH4) and carbon dioxide (CO2) emissions from US reservoirs.  Gas emissions are measured at >= 15 locations within each reservoir.  Water chemistry samples are collected from two depths (near the air-water interface and the sediment-water interface) at one location within each reservoir.  At a subset of the reservoirs, field blanks and field duplicates are also collected.  This report details results from the field blanks and duplicates.


## Detection Limits

### Create dataframe of detection limits for use with all following plots

```{r echo=FALSE, message=FALSE, warning=FALSE}

name = c("al", "as", "ba", "be", "br", "br", "ca", "cd", "cl", "cl", "cr", "cu", "doc", "f", "f", "fe", "k", "li", "mg", "mn", "na", "nh4", "nh4", "nh4", "ni", "no2", "no2", "no2", "no2_3", "no2_3", "no2_3", "no3", "no3", "no3", "op", "p", "pb", "po4", "po4", "s", "sb", "si", "sn", "so4", "so4", "sr", "tn", "tn", "tn", "toc", "toc", "tp", "tp", "tp", "op", "op", "v", "zn") 
mdl = c(0.004, 0.004, 0.001, 0.005, 0.041, 0.02, 0.010, 0.0003, 0.026, 0.03, 0.001, 0.001, 0.102, 0.014, 0.005, 0.001, 0.300, 0.005, 0.005, 0.001, 0.030, 6, 6, 1.71, 0.001, 1.2, 6, 1.2, 6, 6, 10, 10, 6, 10, 2, 0.005, 0.002, 2, 15, 3, 0.003, 0.020, 0.001, 0.151, 0.025, 0.001, 20.9, 25, 2, 0.1, 0.102, 8, 5, 2, 3, 3, 0.001, 0.0005)
lab = c("CIN", "CIN", "CIN", "CIN", "ADA", "CIN", "CIN", "CIN", "ADA", "CIN", "CIN", "CIN", "ADA", "ADA", "CIN", "CIN", "CIN", "CIN", "CIN", "CIN", "CIN", "CIN", "CIN", "ADA", "CIN", "ADA", "CIN", "ADA", "CIN", "CIN", "ADA", "ADA", "CIN", "ADA", "ADA", "CIN", "CIN", "ADA", "CIN", "CIN", "CIN", "CIN", "CIN", "ADA", "CIN", "CIN", "CIN", "CIN", "ADA", "CIN", "ADA", "CIN", "CIN", "ADA", "CIN", "CIN", "CIN", "CIN") 
year = c("All", "All", "All", "All", "2021", "2021", "All", "All", "2021", "2021", "All", "All", "2021", "2021", "2021", "All", "All", "All", "All", "All", "All", "2018", "2021", "2020", "All", "2021", "2021", "2020", "2018", "2021", "2020", "2021", "2021", "2020", "2020", "All", "All", "2021", "2021", "All", "All", "All", "All", "2021", "2021", "All", "2018", "2021", "2020", "All", "2021", "2018", "2021", "2020", "2018", "2021", "All", "All")

# need to add chl-a detection limit when available
detlimits <- data.frame(name, mdl, lab, year) 

```

## Field Blanks

### ADA Anions
Fluoride and bromide were below the detection limit for all field blanks from ADA.  Chloride and sulfate were about 3-fold greater than the detection limit in field blanks from lake 148, but were still 4-5 orders of magnitude lower than the unknowns from that lake. 

```{r echo=FALSE, message=FALSE, warning=FALSE}


# table
# formatting guide https://cran.r-project.org/web/packages/kableExtra/vignettes/awesome_table_in_pdf.pdf
ada.anions %>% 
  ungroup() %>%
  mutate(sample_type = case_when(sample_type == "duplicate" ~ "unknown", TRUE ~ sample_type)) %>%
  select(!c(site_id, sample_depth), -matches("flag|qual|units")) %>% 
  pivot_longer(!c(lake_id, sample_type)) %>% 
  group_by(lake_id, name, sample_type) %>% 
  summarize(min = round(min(value),3),  max = round(max(value),2)) %>% 
  pivot_wider(names_from = sample_type, values_from = c(min, max)) %>% 
  select(-max_blank) %>%
  left_join(y = filter(detlimits, lab == "ADA"), by = "name") %>%
  select(-lab, -year) %>%
  rename(anion = name, blank = min_blank, minimum = min_unknown, maximum = max_unknown) %>%
  relocate(lake_id, anion, mdl, blank, minimum, maximum) %>%
  kableExtra::kbl(booktabs = TRUE, # nice formatting
                  caption = "Minimum and Maximum Anion Concentrations Measured at ADA") %>% # table title
  kableExtra::add_header_above(c(" ", " ", " ", " ", "Unknowns" = 2)) %>% # header above the unknowns
  kableExtra::column_spec(1, bold = TRUE) %>%
  kableExtra::collapse_rows(columns = 1, valign = "top")


ada.anions %>% ungroup() %>%
  select(!c(site_id, sample_depth), -matches("flag|qual|units")) %>%
  mutate(sample_type = case_when(sample_type == "duplicate" ~ "unknown", TRUE ~ sample_type)) %>%
  pivot_longer(cols = !c(lake_id, sample_type)) %>%
  left_join(y = filter(detlimits, lab == "ADA"), by = "name") %>%
  ggplot() +
  aes(lake_id, value) +
  geom_point(aes(color = sample_type)) +
  geom_hline(aes(yintercept=mdl, linetype = "minimum detection limit"), 
             color = "red") + # add horizontal lines for det. limits
  theme(legend.title = element_blank()) + # remove legend titles
  ggtitle("ADA Anion Samples") +
  facet_wrap(~name, scales = "free")  +
  theme(legend.position = "bottom")

```

### CIN Anions
Anion samples collected in 2020 by field crews other than ADA were analyzed at EPA Cincinnati.  All bromide blanks were below the detection limit, as where most of the unknowns.  Most chloride blanks were below the detection limit and all were several orders of magnitude below the unknowns.  Lake 233 had a high F blank, but all others were at DL.  Sulfate blanks were near the detection limit and several orders of magnitude below the unknowns.

```{r echo=FALSE, message=FALSE, warning=FALSE, fig.width=10, fig.height=11}


# table
# formatting guide https://cran.r-project.org/web/packages/kableExtra/vignettes/awesome_table_in_pdf.pdf
d.anions %>% 
  ungroup() %>%
  mutate(sample_type = case_when(sample_type == "duplicate" ~ "unknown", TRUE ~ sample_type)) %>%
  select(!c(site_id, sample_depth), -matches("flag|qual|units")) %>% 
  pivot_longer(!c(lake_id, sample_type)) %>% 
  group_by(lake_id, name, sample_type) %>% 
  summarize(min = round(min(value),3),  max = round(max(value),2)) %>% 
  pivot_wider(names_from = sample_type, values_from = c(min, max)) %>% 
  select(-max_blank) %>%
  left_join(y = filter(detlimits, lab == "CIN"), by = "name") %>%
  select(-lab, -year) %>%
  rename(anion = name, blank = min_blank, minimum = min_unknown, maximum = max_unknown) %>%
  relocate(lake_id, anion, mdl, blank, minimum, maximum) %>%
  kableExtra::kbl(booktabs = TRUE, # nice formatting
                  caption = "Minimum and Maximum Anion Concentrations Measured at CIN") %>% # table title
  kableExtra::add_header_above(c(" ", " ", " ", " ", "Unknowns" = 2)) %>% # header above the unknowns
  kableExtra::column_spec(1, bold = TRUE) %>%
  kableExtra::collapse_rows(columns = 1, valign = "top")


d.anions %>% ungroup() %>%
  select(!c(site_id, sample_depth), -matches("flag|qual|units")) %>%
  mutate(sample_type = case_when(sample_type == "duplicate" ~ "unknown", TRUE ~ sample_type)) %>%
  pivot_longer(cols = !c(lake_id, sample_type)) %>%
  left_join(y = filter(detlimits, lab == "CIN"), by = "name") %>%
  ggplot() +
  aes(lake_id, value) +
  geom_point(aes(color = sample_type)) +
  scale_y_log10() +
  geom_hline(aes(yintercept=mdl, linetype = "minimum detection limit"), 
             color = "red") + # add horizontal lines for det. limits
  theme(legend.title = element_blank(),  # remove legend titles
          axis.text.x = element_text(angle = 90, hjust = 1)) +
  ggtitle("CIN Anion Samples") +
  facet_wrap(~name, scales = "free") +
  theme(legend.position = "bottom")

```


### Nutrients 2018
Nutrient samples collected by Region 10 in 2018 were analyzed via Lachat in CIN. 

```{r echo=FALSE, message=FALSE, warning=FALSE, fig.width=10, fig.height=11}


# table
# formatting guide https://cran.r-project.org/web/packages/kableExtra/vignettes/awesome_table_in_pdf.pdf
chem18 %>% 
  ungroup() %>%
  mutate(sample_type = case_when(sample_type == "duplicate" ~ "unknown", TRUE ~ sample_type)) %>%
  select(!c(site_id, sample_depth), -matches("flag|qual|units")) %>% 
  pivot_longer(!c(lake_id, sample_type)) %>% 
  group_by(lake_id, name, sample_type) %>% 
  summarize(min = round(min(value),3),  max = round(max(value),2)) %>% 
  pivot_wider(names_from = sample_type, values_from = c(min, max)) %>% 
  select(-max_blank) %>%
  left_join(y = filter(detlimits, lab == "CIN" & year == "2018"), by = "name") %>%
  select(-lab, -year) %>%
  rename(nutrient = name, blank = min_blank, minimum = min_unknown, maximum = max_unknown) %>%
  relocate(lake_id, nutrient, mdl, blank, minimum, maximum) %>%
  kableExtra::kbl(booktabs = TRUE, # nice formatting
                  caption = "Minimum and Maximum Nutrient Concentrations Measured in 2018 Samples Analyzed at CIN") %>% # table title
    kableExtra::add_header_above(c(" ", " ", " ", " ", "Unknowns" = 2)) %>% # header above the unknowns
  kableExtra::column_spec(1, bold = TRUE) %>%
  kableExtra::collapse_rows(columns = 1, valign = "top")


chem18 %>% ungroup() %>%
  select(!c(site_id, sample_depth), -matches("flag|qual|units")) %>%
  mutate(sample_type = case_when(sample_type == "duplicate" ~ "unknown", TRUE ~ sample_type)) %>%
  pivot_longer(cols = !c(lake_id, sample_type)) %>%
  left_join(y = filter(detlimits, lab == "CIN" & year == "2018"), by = "name") %>%
  ggplot() +
  aes(lake_id, value) +
  geom_point(aes(color = sample_type)) +
  scale_y_log10() +
  geom_hline(aes(yintercept=mdl, linetype = "minimum detection limit"), 
             color = "red") + # add horizontal lines for det. limits
  theme(legend.title = element_blank(),  # remove legend titles
          axis.text.x = element_text(angle = 90, hjust = 1)) +
  ggtitle("2018 Nutrients Analyzed at CIN") +
  facet_wrap(~name, scales = "free") +
  theme(legend.position = "bottom")

```

### Nutrients ADA
2021 SuRGE samples collected by ADA field crew were analyzed at the General Paramaters Laboratory in ADA.

```{r echo=FALSE, message=FALSE, warning=FALSE, fig.width=10, fig.height=11}


# table
# formatting guide https://cran.r-project.org/web/packages/kableExtra/vignettes/awesome_table_in_pdf.pdf
ada.nutrients %>% 
  ungroup() %>%
  mutate(sample_type = case_when(sample_type == "duplicate" ~ "unknown", TRUE ~ sample_type)) %>%
  select(!c(site_id, sample_depth), -matches("flag|qual|units")) %>% 
  select(-no3) %>% # not needed for now
  pivot_longer(!c(lake_id, sample_type)) %>% 
  group_by(lake_id, name, sample_type) %>% 
  summarize(min = round(min(value),2),  max = round(max(value),2)) %>% 
  pivot_wider(names_from = sample_type, values_from = c(min, max)) %>% 
  select(-max_blank) %>%
  left_join(y = filter(detlimits, lab == "ADA"), by = "name") %>%
  select(-lab, -year) %>%
  rename(nutrient = name, blank = min_blank, minimum = min_unknown, maximum = max_unknown) %>%
  relocate(lake_id, nutrient, mdl, blank, minimum, maximum) %>%
  kableExtra::kbl(booktabs = TRUE, # nice formatting
                  caption = "Minimum and Maximum Nutrient Concentrations Measured at ADA") %>% # table title
cccc
  kableExtra::column_spec(1, bold = TRUE) %>%
  kableExtra::collapse_rows(columns = 1, valign = "top")


ada.nutrients %>% ungroup() %>%
  select(!c(site_id, sample_depth), -matches("flag|qual|units")) %>%
  select(-no3) %>% # not needed for now
  mutate(sample_type = case_when(sample_type == "duplicate" ~ "unknown", TRUE ~ sample_type)) %>%
  pivot_longer(cols = !c(lake_id, sample_type)) %>%
  left_join(y = filter(detlimits, lab == "ADA"), by = "name") %>%
  ggplot() +
  aes(lake_id, value) +
  geom_point(aes(color = sample_type)) +
  scale_y_log10() +
  geom_hline(aes(yintercept=mdl, linetype = "minimum detection limit"), 
             color = "red") + # add horizontal lines for det. limits
  theme(legend.title = element_blank(),  # remove legend titles
          axis.text.x = element_text(angle = 90, hjust = 1)) +
  ggtitle("2021 Nutrients Analyzed at ADA") +
  facet_wrap(~name, scales = "free") +
  theme(legend.position = "bottom")

```

### Nutrients AWBERC
2021 SuRGE samples collected by field crews other than ADA were analyzed in CIN. 

```{r echo=FALSE, message=FALSE, warning=FALSE, fig.width=10, fig.height=11}


# table
# formatting guide https://cran.r-project.org/web/packages/kableExtra/vignettes/awesome_table_in_pdf.pdf
chem21 %>% 
  ungroup() %>%
  mutate(sample_type = case_when(sample_type == "duplicate" ~ "unknown", TRUE ~ sample_type)) %>%
  select(!c(site_id, sample_depth), -matches("flag|qual|units")) %>% 
  pivot_longer(!c(lake_id, sample_type)) %>% 
  group_by(lake_id, name, sample_type) %>% 
  summarize(min = round(min(value),2),  max = round(max(value),2)) %>% 
  pivot_wider(names_from = sample_type, values_from = c(min, max)) %>% 
  select(-max_blank) %>%
  left_join(y = filter(detlimits, lab == "CIN" & year == "2021"), by = "name") %>%
  select(-lab, -year) %>%
  rename(nutrient = name, blank = min_blank, minimum = min_unknown, maximum = max_unknown) %>%
  relocate(lake_id, nutrient, mdl, blank, minimum, maximum) %>%
  kableExtra::kbl(booktabs = TRUE, # nice formatting
                  caption = "Minimum and Maximum Nutrient Concentrations Measured in 2021 SuRGE Samples Analyzed at CIN") %>% # table title
  kableExtra::add_header_above(c(" ", " ", " ", " ", "Unknowns" = 2)) %>% # header above the unknowns
  kableExtra::column_spec(1, bold = TRUE) %>%
  kableExtra::collapse_rows(columns = 1, valign = "top")


chem21 %>% ungroup() %>%
  select(!c(site_id, sample_depth), -matches("flag|qual|units")) %>%
  mutate(sample_type = case_when(sample_type == "duplicate" ~ "unknown", TRUE ~ sample_type)) %>%
  pivot_longer(cols = !c(lake_id, sample_type)) %>%
  left_join(y = filter(detlimits, lab == "CIN" & year == "2021"), by = "name") %>%
  ggplot() +
  aes(lake_id, value) +
  geom_point(aes(color = sample_type)) +
  scale_y_log10() +
  geom_hline(aes(yintercept=mdl, linetype = "minimum detection limit"), 
             color = "red") + # add horizontal lines for det. limits
  theme(legend.title = element_blank(),  # remove legend titles
          axis.text.x = element_text(angle = 90, hjust = 1)) +
  ggtitle("2021 Nutrients Analyzed at AWBERC") +
  facet_wrap(~name, scales = "free") +
  theme(legend.position = "bottom")

```


### Metals
Text about metals placeholder. 

```{r echo=FALSE, message=FALSE, warning=FALSE}


# table
# formatting guide https://cran.r-project.org/web/packages/kableExtra/vignettes/awesome_table_in_pdf.pdf
tteb.all %>% 
  ungroup() %>%
  select(-cin_shipping_notes, -comment, -contains("toc")) %>%
  mutate(sample_type = case_when(sample_type == "duplicate" ~ "unknown", TRUE ~ sample_type)) %>%
  select(!c(site_id, sample_depth), -matches("flag|qual|units")) %>% 
  pivot_longer(!c(lake_id, sample_type)) %>% 
  group_by(lake_id, name, sample_type) %>% 
  summarize(min = round(min(value),2),  max = round(max(value),2)) %>% 
  pivot_wider(names_from = sample_type, values_from = c(min, max)) %>% 
  select(-max_blank) %>%
  left_join(y = filter(detlimits, lab == "CIN"), by = "name") %>%
  select(-lab, -year) %>%
  rename(metal = name, blank = min_blank, minimum = min_unknown, maximum = max_unknown) %>%
  relocate(lake_id, metal, mdl, blank, minimum, maximum) %>%
  kableExtra::kbl(booktabs = TRUE, # nice formatting
                  caption = "Minimum and Maximum Metals Concentrations in Unknowns") %>% # table title
  kableExtra::add_header_above(c(" ", " ", " ", " ", "Unknowns" = 2)) %>% # header above the unknowns
  kableExtra::column_spec(1, bold = TRUE) %>%
  kableExtra::collapse_rows(columns = 1, valign = "top")



tteb.all %>% ungroup() %>%
  select(-cin_shipping_notes, -comment) %>%
  select(!c(site_id, sample_depth), -matches("flag|qual|units")) %>%
  mutate(sample_type = case_when(sample_type == "duplicate" ~ "unknown", TRUE ~ sample_type)) %>%
  pivot_longer(cols = !c(lake_id, sample_type)) %>%
  left_join(y = filter(detlimits, lab == "CIN"), by = "name") %>%
  ggplot() +
  aes(lake_id, value) +
  geom_point(aes(color = sample_type)) +
  geom_hline(aes(yintercept=mdl, linetype = "minimum detection limit"), 
             color = "red") + # add horizontal lines for det. limits
  theme(legend.title = element_blank()) + # remove legend titles
  ggtitle("Metals field blanks") +
  facet_wrap(~name, scales = "free") +
  theme(legend.position = "bottom")

```


### Organic Carbon MASI
TOC MASI text placeholder. 

```{r echo=FALSE, message=FALSE, warning=FALSE}


# table
# formatting guide https://cran.r-project.org/web/packages/kableExtra/vignettes/awesome_table_in_pdf.pdf
ada.oc %>% 
  ungroup() %>%
  mutate(sample_type = case_when(sample_type == "duplicate" ~ "unknown", TRUE ~ sample_type)) %>%
  select(!c(site_id, sample_depth), -matches("flag|qual|units")) %>% 
  pivot_longer(!c(lake_id, sample_type)) %>% 
  group_by(lake_id, name, sample_type) %>% 
  summarize(min = round(min(value),2),  max = round(max(value),2)) %>% 
  pivot_wider(names_from = sample_type, values_from = c(min, max)) %>% 
  select(-max_blank) %>%
  left_join(y = filter(detlimits, lab == "CIN"), by = "name") %>%
  select(-lab, -year) %>%
  rename(OC = name, blank = min_blank, minimum = min_unknown, maximum = max_unknown) %>%
  kableExtra::kbl(booktabs = TRUE, # nice formatting
                  caption = "Minimum and Maximum TOC Concentrations in Unknowns") %>% # table title
  kableExtra::add_header_above(c(" ", " ", " ", "Unknowns" = 2)) # header above the unknowns
  # kableExtra::pack_rows("", 1, 4) %>% # space between first and second lake
  # kableExtra::pack_rows("", 5, 8) %>% # space between first and second lake
  # kableExtra::pack_rows("", 9, 12) # space between second and third lake


ada.oc %>% ungroup() %>%
  select(!c(site_id, sample_depth), -matches("flag|qual|units")) %>%
  mutate(sample_type = case_when(sample_type == "duplicate" ~ "unknown", TRUE ~ sample_type)) %>%
  pivot_longer(cols = !c(lake_id, sample_type)) %>%
  left_join(y = filter(detlimits, lab == "CIN"), by = "name") %>%
  ggplot() +
  aes(lake_id, value) +
  geom_point(aes(color = sample_type)) +
  geom_hline(aes(yintercept=mdl, linetype = "minimum detection limit"), 
             color = "red") + # add horizontal lines for det. limits
  theme(legend.title = element_blank()) + # remove legend titles
  ggtitle("TOC field blanks") +
  facet_wrap(~name, scales = "free")

```


### Organic Carbon ADA
OC ADA text placeholder. 

```{r echo=FALSE, message=FALSE, warning=FALSE}


# table
# formatting guide https://cran.r-project.org/web/packages/kableExtra/vignettes/awesome_table_in_pdf.pdf
toc.masi %>% 
  ungroup() %>%
  mutate(sample_type = case_when(sample_type == "duplicate" ~ "unknown", TRUE ~ sample_type)) %>%
  select(!c(site_id, sample_depth), -matches("flag|qual|units")) %>% 
  pivot_longer(!c(lake_id, sample_type)) %>% 
  group_by(lake_id, name, sample_type) %>% 
  summarize(min = round(min(value),2),  max = round(max(value),2)) %>% 
  pivot_wider(names_from = sample_type, values_from = c(min, max)) %>% 
  select(-max_blank) %>%
  left_join(y = filter(detlimits, lab == "ADA"), by = "name") %>%
  select(-lab, -year) %>%
  rename(OC = name, blank = min_blank, minimum = min_unknown, maximum = max_unknown) %>%
  kableExtra::kbl(booktabs = TRUE, # nice formatting
                  caption = "Minimum and Maximum TOC Concentrations in Unknowns") %>% # table title
  kableExtra::add_header_above(c(" ", " ", " ", "Unknowns" = 2)) # header above the unknowns
  # kableExtra::pack_rows("", 1, 4) %>% # space between first and second lake
  # kableExtra::pack_rows("", 5, 8) %>% # space between first and second lake
  # kableExtra::pack_rows("", 9, 12) # space between second and third lake


toc.masi %>% ungroup() %>%
  select(!c(site_id, sample_depth), -matches("flag|qual|units")) %>%
  mutate(sample_type = case_when(sample_type == "duplicate" ~ "unknown", TRUE ~ sample_type)) %>%
  pivot_longer(cols = !c(lake_id, sample_type)) %>%
  left_join(y = filter(detlimits, lab == "ADA"), by = "name") %>%
  ggplot() +
  aes(lake_id, value) +
  geom_point(aes(color = sample_type)) +
  geom_hline(aes(yintercept=mdl, linetype = "minimum detection limit"), 
             color = "red") + # add horizontal lines for det. limits
  theme(legend.title = element_blank()) + # remove legend titles
  ggtitle("TOC field blanks") +
  facet_wrap(~name, scales = "free")

```

### Algal pigments
Text about algal pigments here. 

```{r echo=FALSE, message=FALSE, warning=FALSE}


# table
# formatting guide https://cran.r-project.org/web/packages/kableExtra/vignettes/awesome_table_in_pdf.pdf
chl18 %>% 
  ungroup() %>%
  mutate(sample_type = case_when(sample_type == "duplicate" ~ "unknown", TRUE ~ sample_type)) %>%
  select(!c(site_id, sample_depth), -matches("flag|qual|units")) %>% 
  pivot_longer(!c(lake_id, sample_type)) %>% 
  group_by(lake_id, name, sample_type) %>% 
  summarize(min = round(min(value),2),  max = round(max(value),2)) %>% 
  pivot_wider(names_from = sample_type, values_from = c(min, max)) %>% 
  select(-max_blank) %>%
  left_join(y = filter(detlimits, lab == "CIN"), by = "name") %>%
  select(-lab, -year) %>%
  rename(chla = name, blank = min_blank, minimum = min_unknown, maximum = max_unknown)  %>%
  kableExtra::kbl(booktabs = TRUE, # nice formatting
                  caption = "Minimum and Maximum Chlorophyll-A Concentrations in Unknowns") %>% # table title
  kableExtra::add_header_above(c(" ", " ", " ", "Unknowns" = 2))# %>% # header above the unknowns
  # kableExtra::pack_rows("", 1, 4) %>% # space between first and second lake
  # kableExtra::pack_rows("", 5, 8) %>% # space between first and second lake
  # kableExtra::pack_rows("", 9, 12) # space between second and third lake


chl18 %>% ungroup() %>%
  select(!c(site_id, sample_depth), -matches("flag|qual|units")) %>%
  mutate(sample_type = case_when(sample_type == "duplicate" ~ "unknown", TRUE ~ sample_type)) %>%
  pivot_longer(cols = !c(lake_id, sample_type)) %>%
  left_join(y = filter(detlimits, lab == "CIN"), by = "name") %>%
  ggplot() +
  aes(lake_id, value) +
  geom_point(aes(color = sample_type)) +
  geom_hline(aes(yintercept=mdl, linetype = "minimum detection limit"), 
             color = "red") + # add horizontal lines for det. limits
  theme(legend.title = element_blank()) + # remove legend titles
  ggtitle("Chlorophyll-A field blanks") +
  facet_wrap(~name, scales = "free")

```


## Field duplicates
### ADA Anions
Fluoride and bromide were below the detection limit for all field blanks from ADA.  Chloride and sulfate were about 3-fold greater than the detection limit in field blanks from lake 148, but were still 4-5 orders of magnitude lower than the unknowns from that lake. 

```{r echo=FALSE, message=FALSE, warning=FALSE}


# table
# formatting guide https://cran.r-project.org/web/packages/kableExtra/vignettes/awesome_table_in_pdf.pdf
ada.anions %>% 
  ungroup() %>%
  mutate(sample_type = case_when(sample_type == "blank" ~ "unknown", TRUE ~ sample_type)) %>%
  select(!c(site_id, sample_depth), -matches("flag|qual|units")) %>% 
  pivot_longer(!c(lake_id, sample_type)) %>% 
  group_by(lake_id, name, sample_type) %>% 
  summarize(min = round(min(value),2),  max = round(max(value),2)) %>% 
  pivot_wider(names_from = sample_type, values_from = c(min, max)) %>% 
  select(-max_duplicate) %>%
  left_join(y = filter(detlimits, lab == "ADA"), by = "name") %>%
  select(-lab, -year) %>%
  rename(anion = name, duplicate = min_duplicate, minimum = min_unknown, maximum = max_unknown) %>%
  kableExtra::kbl(booktabs = TRUE, # nice formatting
                  caption = "Minimum and Maximum Anion Concentrations Measured at ADA") %>% # table title
  kableExtra::add_header_above(c(" ", " ", " ", "Unknowns" = 2)) %>% # header above the unknowns
  kableExtra::column_spec(1, bold = TRUE) %>%
  kableExtra::collapse_rows(columns = 1, valign = "top")


ada.anions %>% ungroup() %>%
  select(!c(site_id, sample_depth), -matches("flag|qual|units")) %>%
  mutate(sample_type = case_when(sample_type == "blank" ~ "unknown", TRUE ~ sample_type)) %>%
  pivot_longer(cols = !c(lake_id, sample_type)) %>%
  left_join(y = filter(detlimits, lab == "ADA"), by = "name") %>%
  ggplot() +
  aes(lake_id, value) +
  geom_point(aes(color = sample_type)) +
  geom_hline(aes(yintercept=mdl, linetype = "minimum detection limit"), 
             color = "red") + # add horizontal lines for det. limits
  theme(legend.title = element_blank()) + # remove legend titles
  ggtitle("ADA Anion field duplicates") +
  facet_wrap(~name, scales = "free")  +
  theme(legend.position = "bottom")

```

### CIN Anions
Anion samples collected in 2020 by field crews other than ADA were analyzed at EPA Cincinnati.  All bromide blanks were below the detection limit, as where most of the unknowns.  Most chloride blanks were below the detection limit and all were several orders of magnitude below the unknowns.  Lake 233 had a high F blank, but all others were at DL.  Sulfate blanks were near the detection limit and several orders of magnitude below the unknowns.

```{r echo=FALSE, message=FALSE, warning=FALSE, fig.width=10, fig.height=11}


# table
# formatting guide https://cran.r-project.org/web/packages/kableExtra/vignettes/awesome_table_in_pdf.pdf
d.anions %>% 
  ungroup() %>%
  mutate(sample_type = case_when(sample_type == "blank" ~ "unknown", TRUE ~ sample_type)) %>%
  select(!c(site_id, sample_depth), -matches("flag|qual|units")) %>% 
  pivot_longer(!c(lake_id, sample_type)) %>% 
  group_by(lake_id, name, sample_type) %>% 
  summarize(min = round(min(value),2),  max = round(max(value),2)) %>% 
  pivot_wider(names_from = sample_type, values_from = c(min, max)) %>% 
  select(-max_duplicate) %>%
  left_join(y = filter(detlimits, lab == "CIN"), by = "name") %>%
  select(-lab, -year) %>%
  rename(anion = name, duplicate = min_duplicate, minimum = min_unknown, maximum = max_unknown) %>%
  relocate(lake_id, anion, duplicate, minimum, maximum, mdl) %>%
  kableExtra::kbl(booktabs = TRUE, # nice formatting
                  caption = "Minimum and Maximum Anion Concentrations Measured at CIN") %>% # table title
  kableExtra::column_spec(1, bold = TRUE) %>%
  kableExtra::collapse_rows(columns = 1, valign = "top")


d.anions %>% ungroup() %>%
  select(!c(site_id, sample_depth), -matches("flag|qual|units")) %>%
  mutate(sample_type = case_when(sample_type == "blank" ~ "unknown", TRUE ~ sample_type)) %>%
  pivot_longer(cols = !c(lake_id, sample_type)) %>%
  left_join(y = filter(detlimits, lab == "CIN"), by = "name") %>%
  ggplot() +
  aes(lake_id, value) +
  geom_point(aes(color = sample_type)) +
  scale_y_log10() +
  geom_hline(aes(yintercept=mdl, linetype = "minimum detection limit"), 
             color = "red") + # add horizontal lines for det. limits
  theme(legend.title = element_blank(),  # remove legend titles
          axis.text.x = element_text(angle = 90, hjust = 1)) +
  ggtitle("CIN Anion field duplicates") +
  facet_wrap(~name, scales = "free") +
  theme(legend.position = "bottom")

```


### Nutrients 2018
Nutrients 2018 text placeholder. 

```{r echo=FALSE, message=FALSE, warning=FALSE, fig.width=10, fig.height=11}


# table
# formatting guide https://cran.r-project.org/web/packages/kableExtra/vignettes/awesome_table_in_pdf.pdf
chem18 %>% 
  ungroup() %>%
  mutate(sample_type = case_when(sample_type == "blank" ~ "unknown", TRUE ~ sample_type)) %>%
  select(!c(site_id, sample_depth), -matches("flag|qual|units")) %>% 
  pivot_longer(!c(lake_id, sample_type)) %>% 
  group_by(lake_id, name, sample_type) %>% 
  summarize(min = round(min(value),2),  max = round(max(value),2)) %>% 
  pivot_wider(names_from = sample_type, values_from = c(min, max)) %>% 
  select(-max_duplicate) %>%
  left_join(y = filter(detlimits, lab == "CIN" & year == "2018"), by = "name") %>%
  select(-lab) %>%
  rename(nutrient = name, duplicate = min_duplicate, minimum = min_unknown, maximum = max_unknown) %>%
  relocate(lake_id, nutrient, duplicate, minimum, maximum, mdl) %>%
  kableExtra::kbl(booktabs = TRUE, # nice formatting
                  caption = "Minimum and Maximum Nutrient Concentrations PLACEHOLDER") %>% # table title
  kableExtra::column_spec(1, bold = TRUE) %>%
  kableExtra::collapse_rows(columns = 1, valign = "top")


chem18 %>% ungroup() %>%
  select(!c(site_id, sample_depth), -matches("flag|qual|units")) %>%
  mutate(sample_type = case_when(sample_type == "blank" ~ "unknown", TRUE ~ sample_type)) %>%
  pivot_longer(cols = !c(lake_id, sample_type)) %>%
  left_join(y = filter(detlimits, lab == "CIN" & year == "2018"), by = "name") %>%
  ggplot() +
  aes(lake_id, value) +
  geom_point(aes(color = sample_type)) +
  scale_y_log10() +
  geom_hline(aes(yintercept=mdl, linetype = "minimum detection limit"), 
             color = "red") + # add horizontal lines for det. limits
  theme(legend.title = element_blank(),  # remove legend titles
          axis.text.x = element_text(angle = 90, hjust = 1)) +
  ggtitle("2018 nutrients field duplicates") +
  facet_wrap(~name, scales = "free") +
  theme(legend.position = "bottom")

```

### Nutrients ADA
Nutrients ADA text placeholder. 

```{r echo=FALSE, message=FALSE, warning=FALSE, fig.width=10, fig.height=11}


# table
# formatting guide https://cran.r-project.org/web/packages/kableExtra/vignettes/awesome_table_in_pdf.pdf
ada.nutrients %>% 
  ungroup() %>%
  mutate(sample_type = case_when(sample_type == "blank" ~ "unknown", TRUE ~ sample_type)) %>%
  select(!c(site_id, sample_depth), -matches("flag|qual|units")) %>% 
  select(-no3) %>% # not needed for now
  pivot_longer(!c(lake_id, sample_type)) %>% 
  group_by(lake_id, name, sample_type) %>% 
  summarize(min = round(min(value),2),  max = round(max(value),2)) %>% 
  pivot_wider(names_from = sample_type, values_from = c(min, max)) %>% 
  select(-max_duplicate) %>%
  left_join(y = filter(detlimits, lab == "ADA"), by = "name") %>%
  select(-lab) %>%
  rename(nutrient = name, duplicate = min_duplicate, minimum = min_unknown, maximum = max_unknown) %>%
  relocate(lake_id, nutrient, duplicate, minimum, maximum, mdl) %>%
  kableExtra::kbl(booktabs = TRUE, # nice formatting
                  caption = "Minimum and Maximum Nutrient Concentrations Measured at PLACEHOLDER") %>% # table title
  kableExtra::column_spec(1, bold = TRUE) %>%
  kableExtra::collapse_rows(columns = 1, valign = "top")


ada.nutrients %>% ungroup() %>%
  select(!c(site_id, sample_depth), -matches("flag|qual|units")) %>%
  select(-no3) %>% # not needed for now
  mutate(sample_type = case_when(sample_type == "blank" ~ "unknown", TRUE ~ sample_type)) %>%
  pivot_longer(cols = !c(lake_id, sample_type)) %>%
  left_join(y = filter(detlimits, lab == "ADA"), by = "name") %>%
  ggplot() +
  aes(lake_id, value) +
  geom_point(aes(color = sample_type)) +
  scale_y_log10() +
  geom_hline(aes(yintercept=mdl, linetype = "minimum detection limit"), 
             color = "red") + # add horizontal lines for det. limits
  theme(legend.title = element_blank(),  # remove legend titles
          axis.text.x = element_text(angle = 90, hjust = 1)) +
  ggtitle("Nutrients field duplicates") +
  facet_wrap(~name, scales = "free") +
  theme(legend.position = "bottom")

```

### Nutrients AWBERC
Nutrients AWBERC placeholder. 

```{r echo=FALSE, message=FALSE, warning=FALSE, fig.width=10, fig.height=11}


# table
# formatting guide https://cran.r-project.org/web/packages/kableExtra/vignettes/awesome_table_in_pdf.pdf
chem21 %>% 
  ungroup() %>%
  mutate(sample_type = case_when(sample_type == "blank" ~ "unknown", TRUE ~ sample_type)) %>%
  select(!c(site_id, sample_depth), -matches("flag|qual|units")) %>% 
  pivot_longer(!c(lake_id, sample_type)) %>% 
  group_by(lake_id, name, sample_type) %>% 
  summarize(min = round(min(value),2),  max = round(max(value),2)) %>% 
  pivot_wider(names_from = sample_type, values_from = c(min, max)) %>% 
  select(-max_duplicate) %>%
  left_join(y = filter(detlimits, lab == "CIN" & year == "2021"), by = "name") %>%
  select(-lab) %>%
  rename(nutrient = name, duplicate = min_duplicate, minimum = min_unknown, maximum = max_unknown) %>%
  relocate(lake_id, nutrient, duplicate, minimum, maximum, mdl) %>%
  kableExtra::kbl(booktabs = TRUE, # nice formatting
                  caption = "Minimum and Maximum Nutrient Concentrations Measured at PLACEHOLDER") %>% # table title
  kableExtra::column_spec(1, bold = TRUE) %>%
  kableExtra::collapse_rows(columns = 1, valign = "top")


chem21 %>% ungroup() %>%
  select(!c(site_id, sample_depth), -matches("flag|qual|units")) %>%
  mutate(sample_type = case_when(sample_type == "blank" ~ "unknown", TRUE ~ sample_type)) %>%
  pivot_longer(cols = !c(lake_id, sample_type)) %>%
  left_join(y = filter(detlimits, lab == "CIN" & year == "2021"), by = "name") %>%
  ggplot() +
  aes(lake_id, value) +
  geom_point(aes(color = sample_type)) +
  scale_y_log10() +
  geom_hline(aes(yintercept=mdl, linetype = "minimum detection limit"), 
             color = "red") + # add horizontal lines for det. limits
  theme(legend.title = element_blank(),  # remove legend titles
          axis.text.x = element_text(angle = 90, hjust = 1)) +
  ggtitle("Nutrients field duplicates") +
  facet_wrap(~name, scales = "free") +
  theme(legend.position = "bottom")

```


### Metals
Text about metals placeholder. 

```{r echo=FALSE, message=FALSE, warning=FALSE}


# table
# formatting guide https://cran.r-project.org/web/packages/kableExtra/vignettes/awesome_table_in_pdf.pdf
tteb.all %>% 
  ungroup() %>%
  select(-cin_shipping_notes, -comment) %>%
  mutate(sample_type = case_when(sample_type == "blank" ~ "unknown", TRUE ~ sample_type)) %>%
  select(!c(site_id, sample_depth), -matches("flag|qual|units")) %>% 
  pivot_longer(!c(lake_id, sample_type)) %>% 
  group_by(lake_id, name, sample_type) %>% 
  summarize(min = round(min(value),2),  max = round(max(value),2)) %>% 
  pivot_wider(names_from = sample_type, values_from = c(min, max)) %>% 
  select(-max_duplicate) %>%
  left_join(y = filter(detlimits, lab == "CIN"), by = "name") %>%
  select(-lab, -year) %>%
  rename(metal = name, duplicate = min_duplicate, minimum = min_unknown, maximum = max_unknown) %>%
  relocate(lake_id, metal, duplicate, minimum, maximum, mdl) %>%
  kableExtra::kbl(booktabs = TRUE, # nice formatting
                  caption = "Minimum and Maximum Metals Concentrations in Unknowns") %>% # table title
  kableExtra::add_header_above(c(" ", " ", " ", "Unknowns" = 2)) # header above the unknowns
  # kableExtra::pack_rows("", 1, 4) %>% # space between first and second lake
  # kableExtra::pack_rows("", 5, 8) %>% # space between first and second lake
  # kableExtra::pack_rows("", 9, 12) # space between second and third lake


tteb.all %>% ungroup() %>%
  select(-cin_shipping_notes, -comment) %>%
  select(!c(site_id, sample_depth), -matches("flag|qual|units")) %>%
  mutate(sample_type = case_when(sample_type == "blank" ~ "unknown", TRUE ~ sample_type)) %>%
  pivot_longer(cols = !c(lake_id, sample_type)) %>%
  left_join(y = filter(detlimits, lab == "CIN"), by = "name") %>%
  ggplot() +
  aes(lake_id, value) +
  geom_point(aes(color = sample_type)) +
  geom_hline(aes(yintercept=mdl, linetype = "minimum detection limit"), 
             color = "red") + # add horizontal lines for det. limits
  theme(legend.title = element_blank()) + # remove legend titles
  ggtitle("Metals field duplicates") +
  facet_wrap(~name, scales = "free") +
  theme(legend.position = "bottom")

```


### Organic Carbon MASI
TOC MASI text placeholder. 

```{r echo=FALSE, message=FALSE, warning=FALSE}


# table
# formatting guide https://cran.r-project.org/web/packages/kableExtra/vignettes/awesome_table_in_pdf.pdf
ada.oc %>% 
  ungroup() %>%
  mutate(sample_type = case_when(sample_type == "blank" ~ "unknown", TRUE ~ sample_type)) %>%
  select(!c(site_id, sample_depth), -matches("flag|qual|units")) %>% 
  pivot_longer(!c(lake_id, sample_type)) %>% 
  group_by(lake_id, name, sample_type) %>% 
  summarize(min = round(min(value),2),  max = round(max(value),2)) %>% 
  pivot_wider(names_from = sample_type, values_from = c(min, max)) %>% 
  select(-max_duplicate) %>%
  left_join(y = filter(detlimits, lab == "CIN"), by = "name") %>%
  select(-lab, -year) %>%
  rename(analyte = name, duplicate = min_duplicate, minimum = min_unknown, maximum = max_unknown) %>%
  relocate(lake_id, analyte, duplicate, minimum, maximum, mdl) %>%
  kableExtra::kbl(booktabs = TRUE, # nice formatting
                  caption = "Minimum and Maximum TOC Concentrations in Unknowns") %>% # table title
  kableExtra::add_header_above(c(" ", " ", " ", "Unknowns" = 2)) # header above the unknowns
  # kableExtra::pack_rows("", 1, 4) %>% # space between first and second lake
  # kableExtra::pack_rows("", 5, 8) %>% # space between first and second lake
  # kableExtra::pack_rows("", 9, 12) # space between second and third lake


ada.oc %>% ungroup() %>%
  select(!c(site_id, sample_depth), -matches("flag|qual|units")) %>%
  mutate(sample_type = case_when(sample_type == "blank" ~ "unknown", TRUE ~ sample_type)) %>%
  pivot_longer(cols = !c(lake_id, sample_type)) %>%
  left_join(y = filter(detlimits, lab == "CIN"), by = "name") %>%
  ggplot() +
  aes(lake_id, value) +
  geom_point(aes(color = sample_type)) +
  geom_hline(aes(yintercept=mdl, linetype = "minimum detection limit"), 
             color = "red") + # add horizontal lines for det. limits
  theme(legend.title = element_blank()) + # remove legend titles
  ggtitle("TOC field duplicates") +
  facet_wrap(~name, scales = "free")

```


### Organic Carbon ADA
OC ADA text placeholder. 

```{r echo=FALSE, message=FALSE, warning=FALSE}


# table
# formatting guide https://cran.r-project.org/web/packages/kableExtra/vignettes/awesome_table_in_pdf.pdf
toc.masi %>% 
  ungroup() %>%
  mutate(sample_type = case_when(sample_type == "blank" ~ "unknown", TRUE ~ sample_type)) %>%
  select(!c(site_id, sample_depth), -matches("flag|qual|units")) %>% 
  pivot_longer(!c(lake_id, sample_type)) %>% 
  group_by(lake_id, name, sample_type) %>% 
  summarize(min = round(min(value),2),  max = round(max(value),2)) %>% 
  pivot_wider(names_from = sample_type, values_from = c(min, max)) %>% 
  select(-max_duplicate) %>%
  left_join(y = filter(detlimits, lab == "ADA"), by = "name") %>%
  select(-lab, -year) %>%
  rename(analyte = name, duplicate = min_duplicate, minimum = min_unknown, maximum = max_unknown) %>%
  relocate(lake_id, analyte, duplicate, minimum, maximum, mdl) %>%
  kableExtra::kbl(booktabs = TRUE, # nice formatting
                  caption = "Minimum and Maximum TOC Concentrations in Unknowns") %>% # table title
  kableExtra::add_header_above(c(" ", " ", " ", "Unknowns" = 2)) # header above the unknowns
  # kableExtra::pack_rows("", 1, 4) %>% # space between first and second lake
  # kableExtra::pack_rows("", 5, 8) %>% # space between first and second lake
  # kableExtra::pack_rows("", 9, 12) # space between second and third lake


toc.masi %>% ungroup() %>%
  select(!c(site_id, sample_depth), -matches("flag|qual|units")) %>%
  mutate(sample_type = case_when(sample_type == "blank" ~ "unknown", TRUE ~ sample_type)) %>%
  pivot_longer(cols = !c(lake_id, sample_type)) %>%
  left_join(y = filter(detlimits, lab == "ADA"), by = "name") %>%
  ggplot() +
  aes(lake_id, value) +
  geom_point(aes(color = sample_type)) +
  geom_hline(aes(yintercept=mdl, linetype = "minimum detection limit"), 
             color = "red") + # add horizontal lines for det. limits
  theme(legend.title = element_blank()) + # remove legend titles
  ggtitle("TOC field duplicates") +
  facet_wrap(~name, scales = "free")

```

### Algal pigments
Text about algal pigments here. 

```{r echo=FALSE, message=FALSE, warning=FALSE}


# table
# formatting guide https://cran.r-project.org/web/packages/kableExtra/vignettes/awesome_table_in_pdf.pdf
chl18 %>% 
  ungroup() %>%
  mutate(sample_type = case_when(sample_type == "blank" ~ "unknown", TRUE ~ sample_type)) %>%
  select(!c(site_id, sample_depth), -matches("flag|qual|units")) %>% 
  pivot_longer(!c(lake_id, sample_type)) %>% 
  group_by(lake_id, name, sample_type) %>% 
  summarize(min = round(min(value),2),  max = round(max(value),2)) %>% 
  pivot_wider(names_from = sample_type, values_from = c(min, max)) %>% 
  select(-max_duplicate) %>%
  left_join(y = filter(detlimits, lab == "CIN"), by = "name") %>%
  rename(chla = name, duplicate = min_duplicate, minimum = min_unknown, maximum = max_unknown)  %>%
  relocate(lake_id, chla, duplicate, minimum, maximum, mdl) %>%
  kableExtra::kbl(booktabs = TRUE, # nice formatting
                  caption = "Minimum and Maximum Chlorophyll-A Concentrations in Unknowns") %>% # table title
  kableExtra::add_header_above(c(" ", " ", " ", "Unknowns" = 2))# %>% # header above the unknowns
  # kableExtra::pack_rows("", 1, 4) %>% # space between first and second lake
  # kableExtra::pack_rows("", 5, 8) %>% # space between first and second lake
  # kableExtra::pack_rows("", 9, 12) # space between second and third lake


chl18 %>% ungroup() %>%
  select(!c(site_id, sample_depth), -matches("flag|qual|units")) %>%
  mutate(sample_type = case_when(sample_type == "blank" ~ "unknown", TRUE ~ sample_type)) %>%
  pivot_longer(cols = !c(lake_id, sample_type)) %>%
  left_join(y = filter(detlimits, lab == "CIN"), by = "name") %>%
  ggplot() +
  aes(lake_id, value) +
  geom_point(aes(color = sample_type)) +
  geom_hline(aes(yintercept=mdl, linetype = "minimum detection limit"), 
             color = "red") + # add horizontal lines for det. limits
  theme(legend.title = element_blank()) + # remove legend titles
  ggtitle("Chlorophyll-A field duplicates") +
  facet_wrap(~name, scales = "free")

```







